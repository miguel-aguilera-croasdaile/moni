<script(src="https://www.paypal.com/sdk/js?client-id=#{ENV['PAYPAL_CLIENT_ID']}")></script>
<div class="container py-3">
  <div class="row">

    <div class="col-sm-12 col-md-6">
      <%= image_tag(@product.photo_url, width: '100%') %>
    </div>

    <div class="col-sm-12 col-md-6">
      <h1><%= @product.name %></h1>
      <p>Some awesome description of our amazing product.</p>
      <p>Amount: <%= humanized_money_with_symbol(@product.price) %></p>

      <div id="paypal-button-container"></div>

      <%= form_tag orders_path do %>
        <%= hidden_field_tag 'product_id', @product.id %>
        <%= submit_tag 'Buy Now', class: 'btn btn-primary' %>
      <% end %>

      <br>

      <%= form_tag orders_path do %>
        <%= hidden_field_tag 'product_id', @product.id %>
        <%= submit_tag 'Add to Cart', class: 'btn btn-primary' %>
      <% end %>

    </div>

  </div>
</div>

<script>

  function setupPaypal() {

    function isPayment() {
      return $('[data-charges-and-payments-section] input[name="orders[product_id]"]:checked').length
    }

    function submitOrderPaypal(chargeID) {
      var $form = $("#order-details");
      $form.append($('<input type="hidden" name="orders[charge_id]"/>').val(chargeID));
      $('#order-type').val('paypal');
      $form.submit();
    }

    paypal.Buttons({
      env: "#{ENV['PAYPAL_ENV']}",
      createOrder: function() {
      },
      onApprove: function(data) {
      }
    }).render('#submit-paypal');
  };

  </script>
